<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery.js"></script>
</head>
<body>

  <div class="container">
    <div class="jumbotron text-center">
      <h1>
        <span class="glyphicon glyphicon-fire"></span>
        Hot Restaurant
      </h1> 
      <hr>
      <h2>We only have 5 tables! Book your seat before they all are gone!</h2>
      <br>
      <a href="/tables">
        <button class="btn btn-primary btn-lg">
          <span class="glyphicon glyphicon-list-alt"></span>
          View Tables
        </button>
      </a>
      <a href="/reserve">
        <button class="btn btn-danger btn-lg">
          <span class="glyphicon glyphicon-credit-card"></span>
          View Tables
        </button>
      </a>
    </div>
    <footer class="footer">
      <p>
        <a href="/api/tables">API Table Link</a>
         | 
        <a href="/api/waitlist">API Waitlist Link</a>
      </p>
    </footer>
  </div>

  
</body>
<script type="text/javascript">
	function runTableQuery(){

// Here we get the location of the root page.
// We use this instead of explicitly saying the URL is localhost:3001 because the url will change when we deploy.
var currentURL = window.location.origin;

// The AJAX function uses the URL of our API to GET the data associated with it (initially set to localhost)
$.ajax({url: currentURL + "/api/tables", method: "GET"})
  .done(function(tableData) {

    // Here we are logging the URL so we have access to it for troubleshooting
    console.log("------------------------------------");
    console.log("URL: " + currentURL + "/api/tables");
    console.log("------------------------------------");

    // Here we then log the NYTData to console, where it will show up as an object.
    console.log(tableData);
    console.log("------------------------------------")

    // Loop through and display each of the customers
    for (var i=0; i<tableData.length; i++){

      // Create the HTML Well (Section) and Add the table content for each reserved table
      var tableSection = $("<div>");
      tableSection.addClass('well');
      tableSection.attr('id', 'tableWell-' + i+1)
      $('#tableSection').append(tableSection);

      var tableNumber = i + 1;


      // Then display the remaining fields in the HTML (Section Name, Date, URL)
      $("#tableWell-"+ i+1).append('<h2><span class="label label-primary">' + tableNumber + "</span> | " + tableData[i].customerID + "</h2>");
    }
  });
}

function runWaitListQuery(){

// Here we get the location of the root page.
// We use this instead of explicitly saying the URL is localhost:3001 because the url will change when we deploy.
var currentURL = window.location.origin;

// The AJAX function uses the URL of our API to GET the data associated with it (initially set to localhost)
$.ajax({url: currentURL + "/api/waitlist", method: "GET"})
  .done(function(waitlistData) {

    // Here we are logging the URL so we have access to it for troubleshooting
    console.log("------------------------------------");
    console.log("URL: " + currentURL + "/api/waitlist");
    console.log("------------------------------------");

    // Here we then log the NYTData to console, where it will show up as an object.
    console.log(waitlistData);
    console.log("------------------------------------")

    // Loop through and display each of the customers
    for (var i=0; i<waitlistData.length; i++){

      // Create the HTML Well (Section) and Add the table content for each reserved table
      var waitlistSection = $("<div>");
      waitlistSection.addClass('well');
      waitlistSection.attr('id', 'waitlistWell-' + i+1)
      $('#waitlistSection').append(waitlistSection);

      var tableNumber = i + 1;

      // Then display the remaining fields in the HTML (Section Name, Date, URL)
      $("#waitlistWell-"+ i+1).append('<h2><span class="label label-primary">' + tableNumber + "</span> | " + waitlistData[i].customerID + "</h2>");
    }
  });
}


function clearTable(){

var currentURL = window.location.origin;
$.ajax({url: currentURL + "/api/clear", method: "POST"})

}

$("#clear").on('click', function(){
alert("Clearing...");
clearTable();


location.reload();
})

runTableQuery();
runWaitListQuery();
</script>
</html>